@page
@model IndexModel
@{
    ViewData["Title"] = "RAI - RTS AI Toolbox";
}

<div class="main-header">
    <div class="nav-container">
        <div class="nav-left">
            <img src="/images/logo.png" alt="R&R AI Logo" class="nav-logo">
            <span class="app-title">RAI - RTS AI Toolbox</span>
        </div>
        <div class="nav-right">
            <span id="navUserEmail" class="user-email">@User.Identity?.Name</span>
            <a href="/MicrosoftIdentity/Account/SignOut" class="logout-btn">Sign Out</a>
        </div>
    </div>
</div>

<div class="chat-container">
    <div class="chat-header">
        <h2>AI Assistant</h2>
        <div class="chat-actions">
            <button id="uploadButton" class="upload-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M12 15V3M6 9L12 3L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M15 20H9C7.89543 20 7 19.1046 7 18V15H17V18C17 19.1046 16.1046 20 15 20Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                Upload Document
                <span id="uploadIndicator" class="upload-indicator" style="display: none;"></span>
            </button>
            <div id="documentsIndicator" class="documents-indicator" style="display: none;">
                <div class="documents-header">
                    <span>ðŸ“„ Documents Available:</span>
                    <button id="clearDocuments" class="clear-docs-btn">Clear All</button>
                </div>
                <div id="documentsList" class="documents-list"></div>
            </div>
        </div>
    </div>

    <div class="chat-messages" id="chatMessages">
        <div class="welcome-message">
            <h2>Welcome to RAI - RTS AI Toolbox</h2>
            <p>Your AI-powered assistant is ready to help. Start a conversation below.</p>
        </div>
    </div>

    <div class="chat-input-container">
        <div class="input-wrapper">
            <textarea id="messageInput" 
                     class="message-input" 
                     placeholder="Type your message here..." 
                     rows="3"></textarea>
            <button id="sendButton" class="send-button" disabled>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" fill="currentColor"/>
                </svg>
            </button>
        </div>
        <div class="input-actions">
            <button id="clearButton" class="action-button">Clear Chat</button>
            <span id="tokenCount" class="token-count">Tokens: 0</span>
        </div>
    </div>
</div>

<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
</div>

<div id="uploadModal" class="upload-modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Upload Document</h3>
            <button id="closeModal" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                        <path d="M12 15V3M6 9L12 3L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M15 20H9C7.89543 20 7 19.1046 7 18V15H17V18C17 19.1046 16.1046 20 15 20Z" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <p>Drag and drop files here or click to browse</p>
                <p class="supported-formats">Supported: PDF, TXT, DOC, DOCX</p>
                <input type="file" id="fileInput" accept=".pdf,.txt,.doc,.docx" multiple style="display: none;">
            </div>
            <div id="uploadedFiles" class="uploaded-files"></div>
        </div>
        <div class="modal-footer">
            <button id="cancelUpload" class="btn-secondary">Cancel</button>
            <button id="processFiles" class="btn-primary" disabled>Process Files</button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/chat.js"></script>
    <script src="~/js/upload.js"></script>
}